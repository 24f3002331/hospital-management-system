<!DOCTYPE html>
<html>
<head>
    <title>Patient History</title>
</head>
<body>

    <p>
        <!-- <a href="{{ url_for('home') }}">Home</a> -->
        {% if current_user.role == 'admin' %}
            | <a href="{{ url_for('admin') }}">Back to Dashboard</a>
        {% else %}
            | <a href="{{ url_for('pat') }}">Back to Dashboard</a>
        {% endif %}
    </p>

    <hr>

    <h1>Medical History: {{ patient.name }}</h1>
    
    <p><strong>Age:</strong> {{ patient.age }}</p>
    <p><strong>Gender:</strong> {{ patient.gender }}</p>
    <p><strong>Contact:</strong> {{ patient.contact_number }}</p>
    <p><strong>Address:</strong> {{ patient.address }}</p>

    <hr>

    <h2>Appointment Records</h2>

    <table border="1" cellpadding="5" cellspacing="0">
        <thead>
            <tr>
                <th>Date</th>
                <th>Time Slot</th>
                <th>Doctor</th>
                <th>Status</th>
                <th>Diagnosis</th>
                <th>Prescription</th>
                <th>Notes</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            {% for appt in appointments %}
            <tr>
                <td>{{ appt.appointment_date }}</td>
                <td>{{ appt.time_slot }}</td>
                <td>
                    {% if appt.doctor %}
                        {{ appt.doctor.name }}
                    {% else %}
                        Unknown
                    {% endif %}
                </td>
                <td>{{ appt.status }}</td>

                {% if appt.treatment %}
                    <td>{{ appt.treatment.diagnosis }}</td>
                    <td>{{ appt.treatment.prescription }}</td>
                    <td>{{ appt.treatment.notes }}</td>
                {% else %}
                    <td>-</td>
                    <td>-</td>
                    <td>-</td>
                {% endif %}
            </tr>
            {% else %}
            <tr>
                <td colspan="8">No appointments found for this patient.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

</body>
</html>