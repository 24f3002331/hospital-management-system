{%extends "base.html"%}
{%block content%}
<h1>Admin dashboard</h1>
{% if current_user.is_authenticated %}
<div>
    <a href="{{url_for('add_doc')}}">add doc</a>
</div>
<h3>Total Doctors</h3>

<h1 style>
    {{ dcount }}
</h1>
<h3>Total Patients</h3>
<h1>
    {{ pcount }}
</h1>



<div>
    <h2>Registered Doctors</h2>


</div>

<div>
    {% for doctor in doctors %}
    <div>

            Dr. {{ doctor.name }}


      
            <a href="{{ url_for('edit_doctor', doctor_id=doctor.id) }}">
                <button>
                    edit
                </button>
            </a>

           <form action="{{ url_for('delete_doctor', doctor_id=doctor.id) }}" method="POST">
    <button type="submit">
        delete
    </button>
</form>
     
    </div>
    {% else %}
    <p>No doctors registered yet.</p>
    {% endfor %}
</div>

<div>
    <h2>Registered Patients</h2>
</div>

<div>
    {% for patient in patients %}

        <span>
            {{ patient.name }}
        </span>


            <a href="{{ url_for('edit_patient', patient_id=patient.id) }}">
                <button>
                    edit
                </button>
            </a>

            <form action="{{ url_for('delete_patient', patient_id=patient.id) }}" method="POST">
                <button type="submit">
                    delete
                </button>
            </form>
   
    </div>
    {% else %}
    <p>No patients registered yet.</p>
    {% endfor %}
</div>

<hr>

<h2>Upcoming Appointments</h2>

<table border="1" cellpadding="10" cellspacing="0">
    <thead>
        <tr>
            <th>ID</th>
            <th>Date</th>
            <th>Time Slot</th>
            <th>Patient Name</th>
            <th>Doctor Name</th>
            <th>Status</th>
            <th>Action</th>
        </tr>
    </thead>
    <tbody>
        {% for appt in appointments %}
        <tr>
            <td>{{ appt.id }}</td>
            <td>{{ appt.appointment_date.strftime('%Y-%m-%d') }}</td>
            <td>{{ appt.time_slot }}</td>
            <td>{{ appt.patient.name }}</td>
            <td>Dr. {{ appt.doctor.name }}</td>
            <td>{{ appt.status }}</td>
            <td>
    <a href="{{ url_for('patient_history',patient_id=appt.patient.id)}}">
        View
    </a>
</td>

        </tr>
        {% else %}
        <tr>
            <td colspan="7">No upcoming appointments found.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>


<h1><a href="{{ url_for('logout') }}">LOG OUTTT</a></h1>
{% endif %}
{% endblock content %}